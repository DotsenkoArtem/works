"use strict"

const LOCATION = { center: [30.251826, 59.9455], zoom: 17 };

const POINTS = [
  {
    coordinates: [30.252896, 59.945477],
    title: "Санкт-Петербург, Малый проспект Васильевского острова, 57к4,",
    size: "60px",
    icon: "data:image/svg+xml;base64,PHN2ZyBpZD0i0KHQu9C+0LlfMSIgZGF0YS1uYW1lPSLQodC70L7QuSAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgMzk3IDM5NyI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOnVybCgj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82KTt9LmNscy0ye2ZpbGw6dXJsKCPQkdC10LfRi9C80Y/QvdC90YvQuV/Qs9GA0LDQtNC40LXQvdGCXzYtMik7fS5jbHMtM3tmaWxsOnVybCgj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82LTMpO308L3N0eWxlPjxsaW5lYXJHcmFkaWVudCBpZD0i0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82IiB4MT0iMTA1IiB5MT0iMzczLjUxIiB4Mj0iMTA1IiB5Mj0iMy4zNCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2MxMjcyZCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk3MjcyZCIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSLQkdC10LfRi9C80Y/QvdC90YvQuV/Qs9GA0LDQtNC40LXQvdGCXzYtMiIgeDE9IjI0Ni4wMSIgeTE9IjEwNS4zOSIgeDI9IjI0Ni4wMSIgeTI9IjI5MS41IiB4bGluazpocmVmPSIj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82Ii8+PGxpbmVhckdyYWRpZW50IGlkPSLQkdC10LfRi9C80Y/QvdC90YvQuV/Qs9GA0LDQtNC40LXQvdGCXzYtMyIgeDE9IjMyMC4xMiIgeTE9Ii0wLjMyIiB4Mj0iMzIwLjEyIiB5Mj0iMzk3LjMyIiB4bGluazpocmVmPSIj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82Ii8+PC9kZWZzPjx0aXRsZT7QnNC+0L3RgtCw0LbQvdCw0Y8g0L7QsdC70LDRgdGC0YwgMTwvdGl0bGU+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMTk5LjUzLDEwNS4zNlYtLjM1YTIyMi44NiwyMjIuODYsMCwwLDAtMzkuMzUsMy42MmMtMy4zLjYzLTQuNDcsMi4xMi00LjQ3LDUuNTMuMTEsMTIuNzYtNC4xNCwyNC40Ni0xMS4xNiwzNWE2Ny41Nyw2Ny41NywwLDAsMS04OCwyMS44MWMtMi42Ni0xLjM5LTQuMzYtMS4xNy02LjE3LDEuMTctMy45NCw1LjEtOC4xOSw5Ljg5LTEyLDE1LjFhMTkyLjgyLDE5Mi44MiwwLDAsMC0yNy4zMyw1My40OWMtMS4xNywzLjQuMjEsNC40NywyLjU1LDYsMTcuNzYsMTEuNywyOC42MSwyOC4xOCwzMC44NCw0OS4xMywyLjc3LDI2LjU5LTcuMjMsNDguMDctMjksNjMuODEtNS43NCw0LjI1LTYsNC4yNS0zLjQsMTAuOTUsOC40LDIyLjM0LDE5Ljc4LDQzLDM1LjMsNjEuMjYsNS4yMiw2LjA2LDUuMTEsNi4wNiwxMi4zNCwzLjNsMy4xOS0xLjI4YzIzLjI5LTEwLjEsNTMuNi00LjY4LDcxLjg5LDEzLjA4LDEzLDEyLjY2LDIwLjYzLDI3Ljg3LDIxLDQ2LjI3LjExLDMuNTEsMS4zOSw1LjMxLDQuOSw1Ljc0YTc1LjU0LDc1LjU0LDAsMCwxLDguNSwxLjI4LDE5NS4xOSwxOTUuMTksMCwwLDAsMzAuNDIsMi40NFYyOTEuNDdhOTMuMDYsOTMuMDYsMCwxLDEsMC0xODYuMTFaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMTk5LjUzLDI5MS41VjEwNS4zOWE5My4wNiw5My4wNiwwLDAsMSwwLDE4Ni4xMVoiLz48cGF0aCBjbGFzcz0iY2xzLTMiIGQ9Ik0zOTcsMzk3LjMyLDM5Ny0uMzJIMjQzLjM1cy0uMTEsNy44Ny0uMTEsOS4xNWE2MCw2MCwwLDAsMCwxMi43NiwzN2MxNi4xNywyMS4zNywzNy44NiwzMC4zMSw2NC4yNCwyNi42OSw3Ljc2LTEuMDYsMTUuMi00LjQ3LDIyLjY1LTcuMjMsMi4zNC0uODUsMy43Mi0uNTMsNS4yMSwxLjE3YTIwMC45LDIwMC45LDAsMCwxLDM2LjksNjAuM2MxLDIuNTUsMS40OSw1LjIxLDIuNjYsNy42NmEzMS42MiwzMS42MiwwLDAsMSwuMjIsNC43OCw5LjgyLDkuODIsMCwwLDEtMy4wOSwyLjY2Yy0xNy41NSwxMS40OS0yNy44NiwyOC0zMC4zMSw0OC41LTIuNzYsMjMuNSw1LjMyLDQzLjYsMjMuMTksNTkuNDVhNTkuMzUsNTkuMzUsMCwwLDAsNy44Nyw1Ljc0LDYsNiwwLDAsMSwyLjM0LDIuMjNjMCwxLjcuMjEsMy44My4xLDMuOTQtNS4xLDE1LjMxLTEyLjEyLDMxLjI2LTIwLjg0LDQ1LTUuMjEsOC4wOS0xOC40LDI3LTMwLjIxLDIxLjkxYTY0Ljg4LDY0Ljg4LDAsMCwwLTQyLTMuNTFjLTE5LjE1LDQuNjgtMzQsMTUuNzQtNDMuNjEsMzMuMjlhNjYuMzIsNjYuMzIsMCwwLDAtNy4xMiwyMS45MWMtLjUzLDMtLjc1LDE3LS43NSwxN0gzOTciLz48L3N2Zz4=",
    element: icon,
  },
  // {
  //   coordinates: [30.252896, 59.945477],
  //   title: 'Санкт-Петербург, Малый проспект Васильевского острова, 57к4',
  //   element: circle,
  //   color: '#C1272D',
  //   radius: '50px',
  //   icon: 'data:image/svg+xml;base64,PHN2ZyBpZD0i0KHQu9C+0LlfMSIgZGF0YS1uYW1lPSLQodC70L7QuSAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgMzk3IDM5NyI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOnVybCgj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82KTt9LmNscy0ye2ZpbGw6dXJsKCPQkdC10LfRi9C80Y/QvdC90YvQuV/Qs9GA0LDQtNC40LXQvdGCXzYtMik7fS5jbHMtM3tmaWxsOnVybCgj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82LTMpO308L3N0eWxlPjxsaW5lYXJHcmFkaWVudCBpZD0i0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82IiB4MT0iMTA1IiB5MT0iMzczLjUxIiB4Mj0iMTA1IiB5Mj0iMy4zNCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2MxMjcyZCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk3MjcyZCIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSLQkdC10LfRi9C80Y/QvdC90YvQuV/Qs9GA0LDQtNC40LXQvdGCXzYtMiIgeDE9IjI0Ni4wMSIgeTE9IjEwNS4zOSIgeDI9IjI0Ni4wMSIgeTI9IjI5MS41IiB4bGluazpocmVmPSIj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82Ii8+PGxpbmVhckdyYWRpZW50IGlkPSLQkdC10LfRi9C80Y/QvdC90YvQuV/Qs9GA0LDQtNC40LXQvdGCXzYtMyIgeDE9IjMyMC4xMiIgeTE9Ii0wLjMyIiB4Mj0iMzIwLjEyIiB5Mj0iMzk3LjMyIiB4bGluazpocmVmPSIj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82Ii8+PC9kZWZzPjx0aXRsZT7QnNC+0L3RgtCw0LbQvdCw0Y8g0L7QsdC70LDRgdGC0YwgMTwvdGl0bGU+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMTk5LjUzLDEwNS4zNlYtLjM1YTIyMi44NiwyMjIuODYsMCwwLDAtMzkuMzUsMy42MmMtMy4zLjYzLTQuNDcsMi4xMi00LjQ3LDUuNTMuMTEsMTIuNzYtNC4xNCwyNC40Ni0xMS4xNiwzNWE2Ny41Nyw2Ny41NywwLDAsMS04OCwyMS44MWMtMi42Ni0xLjM5LTQuMzYtMS4xNy02LjE3LDEuMTctMy45NCw1LjEtOC4xOSw5Ljg5LTEyLDE1LjFhMTkyLjgyLDE5Mi44MiwwLDAsMC0yNy4zMyw1My40OWMtMS4xNywzLjQuMjEsNC40NywyLjU1LDYsMTcuNzYsMTEuNywyOC42MSwyOC4xOCwzMC44NCw0OS4xMywyLjc3LDI2LjU5LTcuMjMsNDguMDctMjksNjMuODEtNS43NCw0LjI1LTYsNC4yNS0zLjQsMTAuOTUsOC40LDIyLjM0LDE5Ljc4LDQzLDM1LjMsNjEuMjYsNS4yMiw2LjA2LDUuMTEsNi4wNiwxMi4zNCwzLjNsMy4xOS0xLjI4YzIzLjI5LTEwLjEsNTMuNi00LjY4LDcxLjg5LDEzLjA4LDEzLDEyLjY2LDIwLjYzLDI3Ljg3LDIxLDQ2LjI3LjExLDMuNTEsMS4zOSw1LjMxLDQuOSw1Ljc0YTc1LjU0LDc1LjU0LDAsMCwxLDguNSwxLjI4LDE5NS4xOSwxOTUuMTksMCwwLDAsMzAuNDIsMi40NFYyOTEuNDdhOTMuMDYsOTMuMDYsMCwxLDEsMC0xODYuMTFaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMTk5LjUzLDI5MS41VjEwNS4zOWE5My4wNiw5My4wNiwwLDAsMSwwLDE4Ni4xMVoiLz48cGF0aCBjbGFzcz0iY2xzLTMiIGQ9Ik0zOTcsMzk3LjMyLDM5Ny0uMzJIMjQzLjM1cy0uMTEsNy44Ny0uMTEsOS4xNWE2MCw2MCwwLDAsMCwxMi43NiwzN2MxNi4xNywyMS4zNywzNy44NiwzMC4zMSw2NC4yNCwyNi42OSw3Ljc2LTEuMDYsMTUuMi00LjQ3LDIyLjY1LTcuMjMsMi4zNC0uODUsMy43Mi0uNTMsNS4yMSwxLjE3YTIwMC45LDIwMC45LDAsMCwxLDM2LjksNjAuM2MxLDIuNTUsMS40OSw1LjIxLDIuNjYsNy42NmEzMS42MiwzMS42MiwwLDAsMSwuMjIsNC43OCw5LjgyLDkuODIsMCwwLDEtMy4wOSwyLjY2Yy0xNy41NSwxMS40OS0yNy44NiwyOC0zMC4zMSw0OC41LTIuNzYsMjMuNSw1LjMyLDQzLjYsMjMuMTksNTkuNDVhNTkuMzUsNTkuMzUsMCwwLDAsNy44Nyw1Ljc0LDYsNiwwLDAsMSwyLjM0LDIuMjNjMCwxLjcuMjEsMy44My4xLDMuOTQtNS4xLDE1LjMxLTEyLjEyLDMxLjI2LTIwLjg0LDQ1LTUuMjEsOC4wOS0xOC40LDI3LTMwLjIxLDIxLjkxYTY0Ljg4LDY0Ljg4LDAsMCwwLTQyLTMuNTFjLTE5LjE1LDQuNjgtMzQsMTUuNzQtNDMuNjEsMzMuMjlhNjYuMzIsNjYuMzIsMCwwLDAtNy4xMiwyMS45MWMtLjUzLDMtLjc1LDE3LS43NSwxN0gzOTciLz48L3N2Zz4='
  // },
  // {
  //   coordinates: [30.252896, 59.945477],
  //   title: 'Санкт-Петербург, Малый проспект Васильевского острова, 57к4',
  //   icon: 'url(data:image/svg+xml;base64,PHN2ZyBpZD0i0KHQu9C+0LlfMSIgZGF0YS1uYW1lPSLQodC70L7QuSAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgMzk3IDM5NyI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOnVybCgj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82KTt9LmNscy0ye2ZpbGw6dXJsKCPQkdC10LfRi9C80Y/QvdC90YvQuV/Qs9GA0LDQtNC40LXQvdGCXzYtMik7fS5jbHMtM3tmaWxsOnVybCgj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82LTMpO308L3N0eWxlPjxsaW5lYXJHcmFkaWVudCBpZD0i0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82IiB4MT0iMTA1IiB5MT0iMzczLjUxIiB4Mj0iMTA1IiB5Mj0iMy4zNCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2MxMjcyZCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk3MjcyZCIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSLQkdC10LfRi9C80Y/QvdC90YvQuV/Qs9GA0LDQtNC40LXQvdGCXzYtMiIgeDE9IjI0Ni4wMSIgeTE9IjEwNS4zOSIgeDI9IjI0Ni4wMSIgeTI9IjI5MS41IiB4bGluazpocmVmPSIj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82Ii8+PGxpbmVhckdyYWRpZW50IGlkPSLQkdC10LfRi9C80Y/QvdC90YvQuV/Qs9GA0LDQtNC40LXQvdGCXzYtMyIgeDE9IjMyMC4xMiIgeTE9Ii0wLjMyIiB4Mj0iMzIwLjEyIiB5Mj0iMzk3LjMyIiB4bGluazpocmVmPSIj0JHQtdC30YvQvNGP0L3QvdGL0Llf0LPRgNCw0LTQuNC10L3Rgl82Ii8+PC9kZWZzPjx0aXRsZT7QnNC+0L3RgtCw0LbQvdCw0Y8g0L7QsdC70LDRgdGC0YwgMTwvdGl0bGU+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMTk5LjUzLDEwNS4zNlYtLjM1YTIyMi44NiwyMjIuODYsMCwwLDAtMzkuMzUsMy42MmMtMy4zLjYzLTQuNDcsMi4xMi00LjQ3LDUuNTMuMTEsMTIuNzYtNC4xNCwyNC40Ni0xMS4xNiwzNWE2Ny41Nyw2Ny41NywwLDAsMS04OCwyMS44MWMtMi42Ni0xLjM5LTQuMzYtMS4xNy02LjE3LDEuMTctMy45NCw1LjEtOC4xOSw5Ljg5LTEyLDE1LjFhMTkyLjgyLDE5Mi44MiwwLDAsMC0yNy4zMyw1My40OWMtMS4xNywzLjQuMjEsNC40NywyLjU1LDYsMTcuNzYsMTEuNywyOC42MSwyOC4xOCwzMC44NCw0OS4xMywyLjc3LDI2LjU5LTcuMjMsNDguMDctMjksNjMuODEtNS43NCw0LjI1LTYsNC4yNS0zLjQsMTAuOTUsOC40LDIyLjM0LDE5Ljc4LDQzLDM1LjMsNjEuMjYsNS4yMiw2LjA2LDUuMTEsNi4wNiwxMi4zNCwzLjNsMy4xOS0xLjI4YzIzLjI5LTEwLjEsNTMuNi00LjY4LDcxLjg5LDEzLjA4LDEzLDEyLjY2LDIwLjYzLDI3Ljg3LDIxLDQ2LjI3LjExLDMuNTEsMS4zOSw1LjMxLDQuOSw1Ljc0YTc1LjU0LDc1LjU0LDAsMCwxLDguNSwxLjI4LDE5NS4xOSwxOTUuMTksMCwwLDAsMzAuNDIsMi40NFYyOTEuNDdhOTMuMDYsOTMuMDYsMCwxLDEsMC0xODYuMTFaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMTk5LjUzLDI5MS41VjEwNS4zOWE5My4wNiw5My4wNiwwLDAsMSwwLDE4Ni4xMVoiLz48cGF0aCBjbGFzcz0iY2xzLTMiIGQ9Ik0zOTcsMzk3LjMyLDM5Ny0uMzJIMjQzLjM1cy0uMTEsNy44Ny0uMTEsOS4xNWE2MCw2MCwwLDAsMCwxMi43NiwzN2MxNi4xNywyMS4zNywzNy44NiwzMC4zMSw2NC4yNCwyNi42OSw3Ljc2LTEuMDYsMTUuMi00LjQ3LDIyLjY1LTcuMjMsMi4zNC0uODUsMy43Mi0uNTMsNS4yMSwxLjE3YTIwMC45LDIwMC45LDAsMCwxLDM2LjksNjAuM2MxLDIuNTUsMS40OSw1LjIxLDIuNjYsNy42NmEzMS42MiwzMS42MiwwLDAsMSwuMjIsNC43OCw5LjgyLDkuODIsMCwwLDEtMy4wOSwyLjY2Yy0xNy41NSwxMS40OS0yNy44NiwyOC0zMC4zMSw0OC41LTIuNzYsMjMuNSw1LjMyLDQzLjYsMjMuMTksNTkuNDVhNTkuMzUsNTkuMzUsMCwwLDAsNy44Nyw1Ljc0LDYsNiwwLDAsMSwyLjM0LDIuMjNjMCwxLjcuMjEsMy44My4xLDMuOTQtNS4xLDE1LjMxLTEyLjEyLDMxLjI2LTIwLjg0LDQ1LTUuMjEsOC4wOS0xOC40LDI3LTMwLjIxLDIxLjkxYTY0Ljg4LDY0Ljg4LDAsMCwwLTQyLTMuNTFjLTE5LjE1LDQuNjgtMzQsMTUuNzQtNDMuNjEsMzMuMjlhNjYuMzIsNjYuMzIsMCwwLDAtNy4xMiwyMS45MWMtLjUzLDMtLjc1LDE3LS43NSwxN0gzOTciLz48L3N2Zz4=)',
  //   color: '#C1272D',
  //   radius: '50px',
  //   draggable: true,
  //   element: circle,
  //   onFastClick: () => alert('Fast click')
  // },
];

function diagram(props) {
  const div = document.createElement("div");

  const diagram = document.createElement("div");

  diagram.className = "pie-marker";
  diagram.style.color = props.color;

  const gradient = [];
  let previous = 0;
  for (let i = 0; i < props.colors.length; i += 1) {
    const p = props.colors[i];
    const deg = (360 / 100) * p.percentage;
    gradient.push(`${p.color} ${previous}deg ${previous + deg}deg`);
    previous = previous + deg;
  }

  diagram.style.background = "conic-gradient(" + gradient.join(", ") + ")";

  const title = document.createElement("div");
  title.innerHTML = props.title;
  title.className = "pie-marker-title";

  div.appendChild(diagram);
  div.appendChild(title);

  return div;
}

function circle(props) {
  const circle = document.createElement("div");
  circle.classList.add("circle");
  circle.style.color = props.color;
  props.radius && circle.style.setProperty("--radius", props.radius);
  props.icon && circle.style.setProperty("--icon", props.icon);
  circle.title = props.title;
  return circle;
}

function icon(props) {
  const circle = document.createElement("div");
  circle.classList.add("icon");
  circle.style.color = props.color;
  circle.style.backgroundImage = `url(${props.icon})`;
  circle.style.setProperty("--size", props.size);

  if (props.title) {
    const title = document.createElement("div");
    title.innerHTML = props.title;
    title.className = "icon-title";
    circle.appendChild(title);
  }

  return circle;
}
