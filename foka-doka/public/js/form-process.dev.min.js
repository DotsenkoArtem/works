"use strict";var sounds={success:"php/audio/success.mp3",error:"php/audio/error-1.mp3"},soundSuccess=new Sound(sounds.success),soundError=new Sound(sounds.error),alertSound=soundSuccess;function Sound(e){var s=document.createElement("audio");s.src=e,this.play=function(){s.play()}}var forms=Array.from(document.forms);function setupLoader(e){var s=document.createElement("div");s.className="submit-loader submit-loader_fixed",wrapper.appendChild(s)}function removeLoader(e){wrapper.querySelector(".submit-loader").remove()}forms.forEach(function(i){var e=i.querySelector('input[type="file"]'),c=e.nextElementSibling;e.addEventListener("change",function(){1==this.files.length&&(c.innerHTML='<div class="form__file_selected-label">Выбран файл: </div><div class="form__file_selected-value">'.concat(this.files[0].name,"</div>")),1<this.files.length&&(c.innerHTML='<div class="form__file_selected-label">Выбрано файлов: </div><div class="form__file_selected-value">'.concat(this.files.length,"</div>"))}),i.addEventListener("submit",function(e){var s,r;e=e,s="../php/send-order.php",setupLoader(i),e.preventDefault?e.preventDefault():e.returnValue=!1,(r=new XMLHttpRequest).open("POST",s,!0),r.onload=function(){var e=document.createElement("div"),s=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div");n.className="thanks__backdrop";function a(){e.classList.remove("active"),e.style.animation="slideUpOut .5s ease forwards",setTimeout(function(){e.remove(),n.remove()},500)}e.className="thanks",s.className="thanks__content",t.className="thanks__close",e.append(s,t),wrapper.append(e),e.before(n),t.onclick=function(){a()},removeLoader(i),200<=r.status&&r.status<400?(t=JSON.parse(this.response),alertSound="success"==t.result?(s.innerHTML='<div class="thanks__title"><span class="text_accent-prim">Спасибо,</span> ваш заказ отправлен!</div><div class="thanks__subtitle">В ближайшее время с вами свяжется наш специалист</div>',e.classList.remove("thanks_error"),e.classList.add("thanks_success"),soundSuccess):("limitExceeded"==t.result?s.innerHTML='<div class="thanks__title"><span class="text_accent-prim">Ошибка.</span></div><div class="thanks__subtitle">Превышен максимальный размер прикрепляемых файлов (10мб).</div>':s.innerHTML='<div class="thanks__title"><span class="text_accent-prim">Ошибка.</span></div><div class="thanks__subtitle">Сообщение не отправлено.</div>',e.classList.remove("thanks_success"),e.classList.add("thanks_error"),soundError)):alert("Ошибка сервера. Номер: "+r.status),e.classList.add("active"),alertSound.play(),i.reset(),c.innerHTML="",setTimeout(function(){a()},5e3)},r.onerror=function(){alert("Ошибка отправки запроса")},r.send(new FormData(e.target))})});